version: 0

name: dependencies
description: Dependency version and security policies
author: earthly

default_image: earthly/lunar-scripts:1.0.0

landing_page:
  display_name: "Dependency Policies"
  long_description: |
    Enforce dependency version requirements across your codebase. Ensure libraries
    meet minimum safe versions to address security vulnerabilities and maintain
    compatibility standards.
  category: "security-and-compliance"
  icon: "assets/dependencies.svg"
  status: "stable"
  requires:
    - slug: "golang"
      type: "collector"
      reason: "Provides Go module dependency data"
  related: []

policies:
  - name: min-versions
    description: |
      Ensures dependencies meet minimum safe version requirements.
      Validates that project dependencies are at or above specified versions
      to enforce security patches and compatibility standards.
    mainPython: ./min_versions.py
    keywords: ["dependency versions", "minimum version", "security", "semver"]

inputs:
  language:
    description: Programming language to check (e.g., "go", "java", "python", "nodejs")
    default: ""
  min_versions:
    description: 'JSON object mapping dependency paths to minimum safe versions (e.g., {"github.com/example/lib": "1.0.0"})'
    default: "{}"
  include_indirect:
    description: 'Whether to also check indirect (transitive) dependencies'
    default: "false"
